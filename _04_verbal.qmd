---
title-meta: verbal
execute:
  warning: false
  echo: false
  message: false
format:
  typst:
    keep-typ: true
  pdf:
    keep-md: true
    keep-tex: true
  html: 
    toc: true
params:
  pheno: verbal
---

<!-- ## Verbal/Language -->

{{< include _04_verbal_text.qmd >}}

```{r}
#| label: data-verbal
data <- bwu::read_data(pheno = "verbal")
```

```{r}
#| label: filter-verbal
scales <- c(
  "Academic Language Readiness Index",
  "Auditory Comprehension Colors",
  "Auditory Comprehension Colors/Shapes/Numbers",
  "Auditory Comprehension Shapes",
  "Auditory Comprehension",
  "Basic Concepts",
  "Bill Payment",
  "Body Part Identification",
  "Body Part Naming",
  "Category Fluency",
  "Comprehension of Instructions",
  "Comprehension",
  "Core Language Score",
  "D-KEFS Color Naming",
  "D-KEFS Word Reading",
  "Descriptive Pragmatics Profile",
  "Early Literacy Index",
  "Expressive Language Index",
  "Expressive Vocabulary",
  "Following Directions",
  "Information",
  "Language Content Index",
  "Language Domain",
  "Language Index",
  "Language Structure Index",
  "Letter Fluency",
  "NAB Language Index",
  "Naming Phonemic Cuing",
  "Naming Semantic Cuing",
  "Naming vs Identification",
  "Naming",
  "Oral Production",
  "Oromotor Sequences",
  "Phonological Awareness",
  "Picture Naming",
  "Picture Naming",
  "Preliteracy Rating Scale",
  "Reading Comprehension",
  "Recalling Sentences",
  "Receptive Language Index",
  "Receptive Vocabulary",
  "Semantic Fluency",
  "Sentence Comprehension",
  "Similarities",
  "Speeded Naming Correct",
  "Speeded Naming Errors",
  "Speeded Naming Time",
  "Speeded Naming",
  "Vocabulary",
  "Word Classes",
  "Word Generation-Initial Letter",
  "Word Generation-Semantic",
  "Word Generation",
  "Word Structure",
  "Writing"
)
domains <- c("Verbal/Language")
data <- bwu::filter_domain_scale(data, domain = domains, scale = scales)
```

```{r}
#| label: text-verbal
#| cache: true
bwu::flatten_scale_text(data, file = "_04_verbal_raw.qmd")
```

```{r}
#| label: qtbl-verbal
#| dev: tikz
#| fig-process: pdf2png
options(tikzDefaultEngine = "xetex")
source_note <- gt::md("*Note:* T-scores (Mean = 50, SD = 10), Scaled scores (Mean =
10, SD = 3).")
table_name <- "table_verbal"
pheno <- "verbal"
bwu::make_tbl_gt(data, pheno = pheno, source_note = source_note, table_name = table_name)
```


```{=typst}
#let domain = "Verbal/Language"
<qtbl-verbal>
#figure([#image("table_verbal.png", width: 50%)],
  caption: [
    #domain Test Scores
  ],
  kind: "qtbl",
  supplement: [Table],
)
```

```{r}
#| label: fig-verbal
#| out-width: 70%
#| fig-cap: "Verbal and language functioning refers to the ability to access and apply acquired word knowledge, to verbalize meaningful concepts, to understand complex multistep instructions, to think about verbal information, and to express oneself using words."

roma <- c( '#7E1700', '#832504', '#883008', '#8E3B0B', '#92450F', '#984E14', '#9C5717', '#A05F1B', '#A4671E', '#A86F22', '#AD7826', '#B0802B', '#B58A30', '#B99336', '#BD9C3D', '#C2A647', '#C7B051', '#CBBA5D', '#CEC56C', '#D0CE7A', '#D2D78A', '#D1DE98', '#CFE4A6', '#CBE7B3', '#C4EABD', '#BCEAC6', '#B2E8CD', '#A7E6D2', '#9BE2D4', '#8EDDD7', '#80D6D7', '#73CED5', '#65C6D5', '#59BDD2', '#4FB5D0', '#45ABCB', '#3DA3C8', '#379BC5', '#3292C2', '#2E8ABF', '#2A81BA', '#2779B7', '#2471B4', '#2269B0', '#1F60AD', '#1B57A8', '#184EA4', '#1344A0', '#0C3B9C', '#023198' )
pheno <- "verbal"
data_dotplot <- dplyr::filter(data, !is.na(percentile))
bwu::make_fig(
  data = data_dotplot,
  pheno = pheno,
  x = data_dotplot$z_mean_subdomain,
  y = data_dotplot$subdomain,
  colors = roma
)
```

```{=typst}
#let domain(title: none, file_qtbl, file_fig) = {
  let font = (font: "Inria Serif", size: 9pt) // 0.71em gives different sizes as opposed to 10pt
  set text(..font)
  grid(
  columns: (40%, 60%),
  gutter: 8pt,
figure([#image(file_qtbl)],
  caption: [
    #title
  ],
  caption-pos: top,
  kind: "qtbl",
  supplement: [*Table*],
),
figure(
  placement: bottom,
  caption: [
    _Premorbid Ability_ is an estimate of a personâ€™s intellectual functioning prior to known or suspected onset of brain disease or dysfunction. _General Ability_ is the overall skill to reason, solve problems, and gain useful knowledge. _Crystallized Knowledge_ involves understanding the world through language and reasoning. _Fluid Reasoning_ is the logical analysis and solution of new problems, identifying underlying patterns, and applying logic.
  ],
  kind: "image",
  supplement: [
    *Figure*
    ],
  gap: 1em,
  [
    #image(file_fig)
    ],
),
)
}
```

```{=typst}
#let file_qtbl = "table_iq.png"
#let file_fig = "_02_iq_files/figure-typst/fig-iq-1.svg"
#domain(
  title: "Intellectual/Neuropsychological Functioning Test Scores",
  file_qtbl,
  file_fig
  )
```
